<?php
class Twig_TokenParser_Sandbox extends Twig_TokenParser { public function parse(Twig_Token $sp650e38) { $this->parser->getStream()->expect(Twig_Token::BLOCK_END_TYPE); $sp1965de = $this->parser->subparse(array($this, 'decideBlockEnd'), true); $this->parser->getStream()->expect(Twig_Token::BLOCK_END_TYPE); if (!$sp1965de instanceof Twig_Node_Include) { foreach ($sp1965de as $spcefb62) { if ($spcefb62 instanceof Twig_Node_Text && ctype_space($spcefb62->getAttribute('data'))) { continue; } if (!$spcefb62 instanceof Twig_Node_Include) { throw new Twig_Error_Syntax('Only "include" tags are allowed within a "sandbox" section', $spcefb62->getLine(), $this->parser->getFilename()); } } } return new Twig_Node_Sandbox($sp1965de, $sp650e38->getLine(), $this->getTag()); } public function decideBlockEnd(Twig_Token $sp650e38) { return $sp650e38->test('endsandbox'); } public function getTag() { return 'sandbox'; } }