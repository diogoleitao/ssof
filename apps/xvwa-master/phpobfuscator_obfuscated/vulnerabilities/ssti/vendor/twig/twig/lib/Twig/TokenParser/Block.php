<?php
class Twig_TokenParser_Block extends Twig_TokenParser { public function parse(Twig_Token $sp650e38) { $sp1f599c = $sp650e38->getLine(); $sp8ec2ac = $this->parser->getStream(); $sp3eec35 = $sp8ec2ac->expect(Twig_Token::NAME_TYPE)->getValue(); if ($this->parser->hasBlock($sp3eec35)) { throw new Twig_Error_Syntax(sprintf("The block '{$sp3eec35}' has already been defined line %d", $this->parser->getBlock($sp3eec35)->getLine()), $sp8ec2ac->getCurrent()->getLine(), $sp8ec2ac->getFilename()); } $this->parser->setBlock($sp3eec35, $sp8a4c10 = new Twig_Node_Block($sp3eec35, new Twig_Node(array()), $sp1f599c)); $this->parser->pushLocalScope(); $this->parser->pushBlockStack($sp3eec35); if ($sp8ec2ac->nextIf(Twig_Token::BLOCK_END_TYPE)) { $sp1965de = $this->parser->subparse(array($this, 'decideBlockEnd'), true); if ($sp650e38 = $sp8ec2ac->nextIf(Twig_Token::NAME_TYPE)) { $spbb4d96 = $sp650e38->getValue(); if ($spbb4d96 != $sp3eec35) { throw new Twig_Error_Syntax(sprintf('Expected endblock for block "%s" (but "%s" given)', $sp3eec35, $spbb4d96), $sp8ec2ac->getCurrent()->getLine(), $sp8ec2ac->getFilename()); } } } else { $sp1965de = new Twig_Node(array(new Twig_Node_Print($this->parser->getExpressionParser()->parseExpression(), $sp1f599c))); } $sp8ec2ac->expect(Twig_Token::BLOCK_END_TYPE); $sp8a4c10->setNode('body', $sp1965de); $this->parser->popBlockStack(); $this->parser->popLocalScope(); return new Twig_Node_BlockReference($sp3eec35, $sp1f599c, $this->getTag()); } public function decideBlockEnd(Twig_Token $sp650e38) { return $sp650e38->test('endblock'); } public function getTag() { return 'block'; } }